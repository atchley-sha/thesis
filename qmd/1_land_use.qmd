# Land Use {#sec-landuse}

```{r}
library(tidyverse)
library(targets)
library(kableExtra)
```

In our first scenario, we changes the land use at The Point.

The change is based on WFRC 2050 SE data forecast, in turn based on development plan of The Point.

This adds X jobs and X households, etc. (show map/table)

@tbl-the-point-overview shows the change in lu data, and @fig-the-point-zones shows these TAZs.

```{r}
#| label: tbl-the-point-overview
#| tbl-cap: the point overview

#tar_read(lu_se_data_comp)
head(mtcars) %>% kbl()
```

```{r}
#| label: fig-the-point-zones
#| fig-cap: the point zones

tar_read(lu_show_location)
```

## Creating the scenario

In the WFRC model the change is trivial to implement.
We just copy/pasted the se data from 2050 to 2019 for the affected zones.

ActivitySim requires two things for this scenario: updated SE data and a new pop.
The updated SE data is the same as in the WFRC scenario, so is also trivial to implement.
The pop, however, is not.
New controls.

New population for only the affected area, then joined to existing.
There were no existing households so we didn't need to remove any (we're not double-counting).

? Note in realistic scenario you could use just the land use forecast as controls directly, rahter than the whole census shenanigains but we didn't do that.

## Analyses

We looked at person-miles for both scenarios.
@fig-lu-personmiles-abm shows the increase in person-miles for the ABM.
Shaded based on "in-zone".
(Not many transit trips since we didn't add transit).
@fig-lu-personmiles-tbm shows for TBM.

```{r}
#| label: fig-lu-personmiles-abm
#| fig-cap: personmiles abm

tar_read(lu_vmt_plot)
```

```{r}
#| label: fig-lu-personmiles-tbm
#| fig-cap: personmiles tbm

tar_read(lu_vmt_plot)
```

Can't really shade since nhb relocation happens before mode choice.
Best you can do is difference the NHB matrices (@fig-lu-desire-tbm (2-panel)) (If there are nhb trips in/out of zones): clearly some of these are not nhb from residents since they occur in these zones.
**Big problem:** They're *all* in the new zones

```{r}
#| label: fig-lu-desire-tbm
#| fig-cap: lu desire tbm
#| fig-subcap: 
#|   - hb
#|   - nhb
#| layout-ncol: 2

tar_read(lu_new_trips_desire_plot) +
  facet_wrap(~mode)

tar_read(lu_nhb_diff_plot) +
  facet_wrap(~mode)
```

With abm, you can follow people and trace their exact paths (@fig-lu-desire-abm).

```{r}
#| label: fig-lu-desire-abm
#| fig-cap: desire abm

tar_read(lu_desire_map) +
  facet_wrap(~mode)
```
